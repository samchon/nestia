# Nestia for Claude Code Users

![Nestia Logo](https://nestia.io/logo.png)

Welcome to Nestia! This guide is specifically designed for developers using Claude (Anthropic's AI assistant) to work with Nestia, a powerful set of helper libraries for NestJS that enhances performance and developer experience.

## Table of Contents

- [What is Nestia?](#what-is-nestia)
- [Key Features Claude Can Help With](#key-features-claude-can-help-with)
- [Getting Started with Claude](#getting-started-with-claude)
- [TypeScript Decorators & Patterns](#typescript-decorators--patterns)
- [SDK Generation](#sdk-generation)
- [Swagger Documentation](#swagger-documentation)
- [E2E Testing](#e2e-testing)
- [AI/LLM Integration](#aillm-integration)
- [Best Practices](#best-practices)
- [Common Patterns & Examples](#common-patterns--examples)
- [Troubleshooting](#troubleshooting)

## What is Nestia?

Nestia is a comprehensive toolkit that supercharges NestJS applications with:

- **ðŸš€ Performance**: 30x faster execution with 20,000x faster runtime validation than `class-validator`
- **ðŸ“ Type Safety**: Pure TypeScript types without decorators overhead
- **ðŸ› ï¸ SDK Generation**: Automatic client SDK generation with typed fetch functions
- **ðŸ“š Enhanced Swagger**: Advanced OpenAPI documentation with AI chatbot support
- **ðŸ§ª E2E Testing**: Automated test function generation
- **ðŸ¤– AI Integration**: Built-in support for LLM function calling via `@agentica`

> **Why Claude?** Claude excels at understanding TypeScript patterns, generating boilerplate code, and helping with complex API integrations - making it perfect for Nestia development!

## Key Features Claude Can Help With

### 1. **Typed Route Controllers**
Claude can help you generate controllers with Nestia's typed decorators:

```typescript
import { Controller, Get, Post } from '@nestjs/common';
import { TypedRoute, TypedBody, TypedQuery } from '@nestia/core';

@Controller('users')
export class UserController {
  @TypedRoute.Get()
  async getUsers(@TypedQuery() query: UserListQuery): Promise<User[]> {
    // Claude can help implement the logic
    return this.userService.findAll(query);
  }

  @TypedRoute.Post()
  async createUser(@TypedBody() userData: CreateUserDto): Promise<User> {
    // Claude can suggest validation and business logic
    return this.userService.create(userData);
  }
}
```

### 2. **Interface Design**
Ask Claude to design TypeScript interfaces that work perfectly with Nestia:

```typescript
// Ask Claude: "Create a user management API interface for Nestia"
interface User {
  id: string;
  email: string;
  name: string;
  createdAt: Date;
  profile?: UserProfile;
}

interface CreateUserDto {
  email: string;
  name: string;
  password: string;
}

interface UserListQuery {
  page?: number;
  limit?: number;
  search?: string;
  sortBy?: 'name' | 'email' | 'createdAt';
  sortOrder?: 'asc' | 'desc';
}
```

## Getting Started with Claude

### Installation Prompts

Ask Claude to help you set up Nestia:

```bash
# Claude can explain each package purpose
npm install @nestia/core @nestia/sdk @nestia/e2e nestia
```

### Project Structure

Ask Claude to analyze or create a Nestia project structure:

```
src/
â”œâ”€â”€ controllers/          # Nestia typed controllers
â”œâ”€â”€ interfaces/          # TypeScript interfaces for APIs
â”œâ”€â”€ services/           # Business logic
â”œâ”€â”€ test/              # E2E tests generated by Nestia
â””â”€â”€ sdk/               # Generated client SDK
```

## TypeScript Decorators & Patterns

### Core Decorators

Claude can help you understand and use Nestia's decorators:

| Decorator | Purpose | Claude Can Help With |
|-----------|---------|---------------------|
| `@TypedRoute.Get()` | Type-safe GET routes | Route design and implementation |
| `@TypedRoute.Post()` | Type-safe POST routes | Request/response modeling |
| `@TypedBody()` | Validated request body | DTO creation and validation logic |
| `@TypedQuery()` | Query parameter validation | Search and filter interfaces |
| `@TypedParam()` | Path parameter validation | URL parameter extraction |
| `@TypedHeaders()` | Header validation | Authentication and metadata |
| `@TypedException()` | Typed error responses | Error handling strategies |

### Advanced Patterns

Ask Claude to help with complex scenarios:

```typescript
// Example: Complex API with nested validation
@Controller('orders')
export class OrderController {
  @TypedRoute.Post()
  async createOrder(
    @TypedBody() order: CreateOrderDto,
    @TypedHeaders() auth: AuthHeaders,
    @TypedQuery() options: OrderOptions,
  ): Promise<Order | OrderError> {
    // Claude can help design the entire flow
    try {
      const validatedOrder = await this.validateOrder(order);
      const user = await this.authService.validateUser(auth.authorization);
      return await this.orderService.create(validatedOrder, user, options);
    } catch (error) {
      return this.handleOrderError(error);
    }
  }
}
```

## SDK Generation

### Automatic Client Generation

Claude can help you understand and customize SDK generation:

```typescript
// nestia.config.ts - Ask Claude to explain configuration options
import { NestiaConfigType } from '@nestia/sdk';

const config: NestiaConfigType = {
  input: 'src/**/*.controller.ts',
  output: 'src/api',
  swagger: {
    output: 'swagger.json',
    security: {
      bearer: {
        type: 'http',
        scheme: 'bearer',
      },
    },
  },
  primitive: false,
  simulate: true,
};

export default config;
```

### Using Generated SDK

Claude can show you how to use the generated client:

```typescript
// Generated SDK usage
import api from './api';

// Type-safe API calls
const users = await api.functional.users.getUsers({
  page: 1,
  limit: 10,
  search: 'john',
});

const newUser = await api.functional.users.createUser({
  email: 'john@example.com',
  name: 'John Doe',
  password: 'secure123',
});
```

## Swagger Documentation

### Enhanced OpenAPI

Claude can help you leverage Nestia's advanced Swagger features:

```typescript
// Add rich documentation that Claude can help write
@Controller('products')
export class ProductController {
  /**
   * Retrieve a paginated list of products
   * 
   * @summary Get product list
   * @description Fetches products with filtering, sorting, and pagination
   * @tag Products
   */
  @TypedRoute.Get()
  async getProducts(
    @TypedQuery() query: ProductQuery,
  ): Promise<PaginatedResponse<Product>> {
    // Implementation
  }
}
```

### AI Chatbot Integration

Nestia supports AI chatbot development - Claude can help you design conversational APIs:

```typescript
// Design chatbot-friendly APIs
interface ChatbotQuery {
  message: string;
  context?: string;
  userId: string;
}

interface ChatbotResponse {
  reply: string;
  suggestions?: string[];
  actions?: BotAction[];
}

@Controller('chatbot')
export class ChatbotController {
  @TypedRoute.Post('chat')
  async chat(@TypedBody() query: ChatbotQuery): Promise<ChatbotResponse> {
    // Claude can help implement LLM integration
    return this.llmService.processMessage(query);
  }
}
```

## E2E Testing

### Automated Test Generation

Claude can help you understand and customize Nestia's E2E test generation:

```typescript
// test/features/api/automated/test_api_users.ts (generated)
import { TestValidator } from '@nestia/e2e';
import api from '../../../src/api';

export const test_api_users_getUsers = async (connection: api.IConnection): Promise<void> => {
  const result = await api.functional.users.getUsers(connection, {
    page: 1,
    limit: 10,
  });
  
  TestValidator.equals('user list')(result.length)(10);
  // Claude can help add custom assertions
};
```

### Custom Test Scenarios

Ask Claude to help create comprehensive test scenarios:

```typescript
// Custom test helpers
export class UserTestHelper {
  static async createTestUser(connection: api.IConnection): Promise<User> {
    return api.functional.users.createUser(connection, {
      email: `test-${Date.now()}@example.com`,
      name: 'Test User',
      password: 'test123',
    });
  }

  static async cleanupTestUsers(connection: api.IConnection): Promise<void> {
    // Claude can help implement cleanup logic
  }
}
```

## AI/LLM Integration

### Using @agentica

Nestia integrates with `@agentica` for LLM function calling. Claude can help you design AI-powered APIs:

```typescript
import { Agentica } from '@agentica/core';

@Controller('ai')
export class AIController {
  @TypedRoute.Post('function-call')
  async handleFunctionCall(
    @TypedBody() request: FunctionCallRequest,
  ): Promise<FunctionCallResponse> {
    // Claude can help implement LLM function routing
    const result = await this.agenticaService.execute(request);
    return this.formatResponse(result);
  }
}

interface FunctionCallRequest {
  function_name: string;
  parameters: Record<string, any>;
  context?: string;
}
```

### LLM-Friendly API Design

Claude can help you design APIs that work well with language models:

```typescript
// Structured for LLM consumption
interface APIOperation {
  name: string;
  description: string;
  parameters: {
    type: 'object';
    properties: Record<string, any>;
    required: string[];
  };
  returns: {
    type: string;
    description: string;
  };
}
```

## Best Practices

### 1. **Type Design**
- Ask Claude to review your interface designs for consistency
- Use descriptive property names that Claude can understand
- Include JSDoc comments for better AI comprehension

### 2. **Error Handling**
```typescript
// Claude can help design comprehensive error types
type APIError = 
  | { type: 'validation'; field: string; message: string }
  | { type: 'authentication'; message: string }
  | { type: 'authorization'; resource: string }
  | { type: 'not_found'; resource: string; id: string }
  | { type: 'conflict'; message: string }
  | { type: 'internal'; message: string };
```

### 3. **Performance Optimization**
Claude can help you optimize Nestia applications:

```typescript
// Efficient query interfaces
interface OptimizedQuery {
  select?: string[]; // Only fetch needed fields
  include?: string[]; // Eager load relationships
  cache?: boolean; // Enable caching
}
```

## Common Patterns & Examples

### 1. **CRUD Operations**

Ask Claude: "Generate a complete CRUD controller for Nestia"

```typescript
@Controller('articles')
export class ArticleController {
  @TypedRoute.Get()
  async list(@TypedQuery() query: ArticleListQuery): Promise<PaginatedResponse<Article>> {
    return this.articleService.findAll(query);
  }

  @TypedRoute.Get(':id')
  async get(@TypedParam('id') id: string): Promise<Article> {
    return this.articleService.findById(id);
  }

  @TypedRoute.Post()
  async create(@TypedBody() data: CreateArticleDto): Promise<Article> {
    return this.articleService.create(data);
  }

  @TypedRoute.Put(':id')
  async update(
    @TypedParam('id') id: string,
    @TypedBody() data: UpdateArticleDto,
  ): Promise<Article> {
    return this.articleService.update(id, data);
  }

  @TypedRoute.Delete(':id')
  async delete(@TypedParam('id') id: string): Promise<void> {
    return this.articleService.delete(id);
  }
}
```

### 2. **File Upload**

```typescript
@Controller('files')
export class FileController {
  @TypedRoute.Post('upload')
  async uploadFile(
    @TypedFormData() form: FileUploadDto,
  ): Promise<FileResponse> {
    // Claude can help with file processing logic
    return this.fileService.upload(form);
  }
}

interface FileUploadDto {
  file: File;
  description?: string;
  tags?: string[];
}
```

### 3. **Real-time Updates**

```typescript
// WebSocket with Nestia
import { WebSocketRoute } from '@nestia/core';

@Controller('realtime')
export class RealtimeController {
  @WebSocketRoute('notifications')
  async handleNotifications(
    @WebSocketRoute.Param('userId') userId: string,
    @WebSocketRoute.Body() message: NotificationMessage,
  ): Promise<NotificationResponse> {
    // Claude can help implement real-time features
    return this.notificationService.process(userId, message);
  }
}
```

## Troubleshooting

### Common Issues Claude Can Help With

1. **Type Errors**: Claude can analyze TypeScript errors and suggest fixes
2. **Decorator Issues**: Understanding which decorator to use when
3. **SDK Generation**: Troubleshooting configuration problems
4. **Performance**: Optimizing query patterns and interfaces
5. **Testing**: Debugging E2E test failures

### Debug Prompts for Claude

- "Why is my TypedBody decorator not validating correctly?"
- "How can I optimize this Nestia controller for better performance?"
- "What's the best way to structure interfaces for this API?"
- "Help me debug this SDK generation error"

### Configuration Help

Claude can help you understand and customize:

```typescript
// nestia.config.ts troubleshooting
const config: NestiaConfigType = {
  input: 'src/**/*.controller.ts',
  output: 'src/api',
  distribute: 'packages/api',
  simulate: true,
  assert: false,
  primitive: false,
  swagger: {
    output: 'swagger.json',
    beautify: true,
    security: {
      bearer: {
        type: 'http',
        scheme: 'bearer',
      },
    },
  },
};
```

## Resources

- **Documentation**: [nestia.io/docs](https://nestia.io/docs/)
- **API Reference**: [nestia.io/api](https://nestia.io/api)
- **GitHub**: [github.com/samchon/nestia](https://github.com/samchon/nestia)
- **Discord**: [Nestia Community](https://discord.gg/E94XhzrUCZ)
- **AI Integration**: [@agentica](https://github.com/wrtnlabs/agentica)
- **Auto Backend**: [@autobe](https://github.com/wrtnlabs/autobe)

## Contributing

When contributing to Nestia with Claude's help:

1. Use Claude to understand the codebase structure
2. Generate comprehensive tests for new features
3. Create clear documentation and examples
4. Follow TypeScript best practices
5. Test SDK generation and E2E scenarios

---

**Happy coding with Nestia and Claude!** ðŸš€

> This documentation is designed to help Claude understand and assist with Nestia development. For human developers, please refer to the main [README.md](./README.md) and [official documentation](https://nestia.io/docs/).